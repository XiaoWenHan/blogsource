---
layout: post
title: "开发手记——基于XMPP的Android即时通讯APP（一）"
date: 2015-02-02 20:37:25
categories: Android开发

---

2015年已经走过了一个月的光景，在一月份，分享了两套视频教程。我个人看过了其中一些，还是很不错的，就是讲课的老师语速慢了点，偶尔有点发困，不知看过的朋友会不会有同感，呵呵。  
关于已经开始的XMPP即时通讯客户端实际上一直是想完成的一个项目，只是一直被工作所困扰，一直没得空。好在现在有点时间，就忙里偷闲了。  
那么作为第一篇文章，自然是**开发环境的搭建和开发的前期准备**。或许代码量不多，或许文章内容还显得很稚嫩，所以欢迎各位前辈前来拍砖，我喜欢板砖！  
首先是**服务器部分**：  

这部分不会介绍太多，因为我们的**重点在客户端**的开发。  
我这里选择的是Openfire，为什么选这个？配置简单，代码开放，用过。
首先，这个服务器软件是跨平台的，兼容Windows、Linux、Mac。  

[下载地址](http://www.igniterealtime.org/downloads/index.jsp#openfire)  

在这个界面上，我们会看到Openfire的安装程序和绿色版压缩文件，还有Spark。都把他们下载下来。  
这里有一个小技巧，如果你的系统中，安装的JDK是1.7及以上的32位版本，最好**下载绿色版的Openfire**，因为安装版会在安装过程刚刚开始的时候报错，导致无法继续（也或许是人品问题）。然后Spark直接下载exe安装就可以了，使用方法类似QQ，随便看看应该就能会用了，将来我们会**使用这个客户端和我们开发的手机APP互通，相互加好友、聊天、传文件等等。**  
解压我们刚刚下载得到的Openfire软件压缩包，放到一个完全英文的路径下，比如D:\Openfire，然后检查系统中的数据库软件。Openfire**支持很多数据库**连接，我这里**以SQL Server 2008 R2为例**，当然，如果系统中没有安装数据库引擎的话，也可以选择嵌入式的数据库。  

![](http://i.imgur.com/HYILBW0.png)

如图，首先打开SQL Server 配置管理器，确保数据库引擎已经在运行。  

![](http://i.imgur.com/caKT9Mj.png)

最后，确保TCP连接是被允许的，如下图配置即可：  

![](http://i.imgur.com/ZViajKm.png)

重新启动SQL Server服务，新建一个名叫“Openfire”的数据库，就可以开始服务器的配置了。  
启动服务器，打开解压后得到的文件夹，进入bin目录，双击openfire.exe，稍等程序运行一会儿后，单击“Launch Admin”按钮，打开控制台。  
程序可选中文语言，一路下一步，来到数据库配置界面，我这里选择SQL Server，然后输入下列信息：  
数据库URL：jdbc:jtds:sqlserver://localhost:1433/Openfire;appName=jive  
用户名和密码是sa。（安装SQL Server时填写）  
接下来继续下一步，填入管理员的密码（切记，每次登录要使用）后，就完成了服务器的配置了。   
最后登录服务器，使用刚才设置好的管理员密码登录，如果一切顺利，将会得到如下图所示的管理界面：  

![](http://i.imgur.com/g8gTf1w.png)

为了测试服务器的运作是正常的，使用之前下载的Spark客户端进行注册和登录即可，这一步骤就不再赘述了，使用过QQ的朋友应该都会很快上手。  
如果能够正常注册和登录，那么就证明我们的服务器配置正确无误，就可以使用它来配合开发Android客户端APP了。这款APP将会用到asmack.jar的库，在接下来的连载里，将会详细介绍该库的使用以及应用如何保持长连接等内容，希望大家前来捧场！